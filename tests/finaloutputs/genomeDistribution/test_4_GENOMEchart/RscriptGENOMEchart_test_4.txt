pdf("test_4_GENOMEchart/PlotGENOMEchart_test_4.pdf")
slices<-c(4,3,3,0,6,8,19)
percent<-round(slices/sum(slices)*100,digits=1)
### FRAMEWORK
mat <- matrix(c(1,2),1)
layout(mat,c(2,1),c(1,1))
### LEFT PANEL
par(mar=c(0.5,0.5,0.5,0.5),lwd = 4)
colfunc<-colorRampPalette(c("darkred","white"))
colors<-colfunc(7)
pie(slices,labels=NA, col=colors,init.angle=90,clockwise=TRUE,radius=1)
text(x=0,y=1.25,"test_4 (43 peaks)",cex=1.75,font=2)
text(x=0,y=-1.25,cex=0.5,font=2,"SeqCode by E. Blanco [Sat Jun  5 19:52:17 2021]")
### RIGHT PANEL
plot(0,0,pch=" ",ylim=c(0,2),xlim=c(0,5),axes=FALSE)
par(mar=c(0.5,0.5,0.5,0.5),lwd = 2)
lines(c(0,0.5),c(1.5,1.5),col=colors[1],lwd=8)
lines(c(0,0.5),c(1.3,1.3),col=colors[2],lwd=8)
lines(c(0,0.5),c(1.1,1.1),col=colors[3],lwd=8)
lines(c(0,0.5),c(0.9,0.9),col=colors[4],lwd=8)
lines(c(0,0.5),c(0.7,0.7),col=colors[5],lwd=8)
lines(c(0,0.5),c(0.5,0.5),col=colors[6],lwd=8)
lines(c(0,0.5),c(0.3,0.3),col="gray97",lwd=8)
text(x=2.5,y=1.7,"REGIONS",cex=2,font=2)
text(x=2.65,y=1.5,"DISTAL",cex=1.5)
string<-paste("(",percent[1],"%)",sep="")
text(x=2.65,y=1.4,string,cex=1.5)
text(x=2.75,y=1.3,"PROXIMAL",cex=1.5)
string<-paste("(",percent[2],"%)",sep="")
text(x=2.65,y=1.2,string,cex=1.5)
text(x=2.75,y=1.1,"5'UTR",cex=1.5)
string<-paste("(",percent[3],"%)",sep="")
text(x=2.65,y=1.0,string,cex=1.5)
text(x=2.75,y=0.9,"3'UTR",cex=1.5)
string<-paste("(",percent[4],"%)",sep="")
text(x=2.65,y=0.8,string,cex=1.5)
text(x=2.75,y=0.7,"CDS",cex=1.5)
string<-paste("(",percent[5],"%)",sep="")
text(x=2.65,y=0.6,string,cex=1.5)
text(x=2.75,y=0.5,"INTRONS",cex=1.5)
string<-paste("(",percent[6],"%)",sep="")
text(x=2.65,y=0.4,string,cex=1.5)
text(x=2.75,y=0.3,"INTERGENIC",cex=1.5)
string<-paste("(",percent[7],"%)",sep="")
text(x=2.65,y=0.2,string,cex=1.5)
rect(-0.15,0.1,5,1.6)
mat <- matrix(1,1)
layout(mat,c(1,1),c(1,1))
plot(0:10, type = "n", xaxt="n", yaxt="n", bty="n", xlab = "", ylab = "")
text(6,9,"Figure legend. Distribution of ChIPseq reads across different regions of the genome.",font=2,cex=0.75)
text(5.75,8.5,"This plot is generated by counting the number of peaks fitting on each class of region.",font=1,cex=0.75)
text(5.925,8,"DISTAL region is the region within 2.5 Kbp and 0.5 Kbp upstream of the TSS. PROXIMAL",font=1,cex=0.75)
text(5.95,7.5,"region is the region within 0.5 Kbp and the TSS. UTR is UnTRanslated sequence. CDS is",font=1,cex=0.75)
text(5.8,7,"the protein CoDing Sequence. INTRONS are intronic regions. INTERGENIC is the rest",font=1,cex=0.75)
text(4.225,6.5,"of the genome. TSS is the Transcription Start Site.",font=1,cex=0.75)
text(6,5.5,"ChIPseq experiment:",font=1,cex=0.75)
text(6,5,"test_4",font=3,cex=0.75)
text(6,4.5,"Number of peaks:",font=1,cex=0.75)
text(6,4,"32",font=3,cex=0.75)
text(6,3.5,"RefSeq transcripts:",font=1,cex=0.75)
text(6,3,"6",font=3,cex=0.75)
text(6,2.5,"Window factor:",font=1,cex=0.75)
text(6,2,"10",font=3,cex=0.75)
text(6,0,cex=0.5,font=2,"SeqCode by E. Blanco [Sat Jun  5 19:52:17 2021]")
dev.off()

